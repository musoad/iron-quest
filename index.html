<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IRON QUEST v4 PRO</title>

  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">

  <meta name="theme-color" content="#0f0f0f">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>

<body>

  <header>
    <h1>⚔ IRON QUEST v4 PRO</h1>
    <div id="playerInfo"></div>
  </header>

  <nav>
    <button data-tab="dashboard">Dashboard</button>
    <button data-tab="log">Log</button>
    <button data-tab="skills">Skilltree</button>
    <button data-tab="analytics">Analytics</button>
    <button data-tab="health">Health</button>
    <button data-tab="boss">Boss</button>
    <button data-tab="challenge">Challenge</button>
    <button data-tab="backup">Backup</button>
  </nav>

  <main>
    <section id="dashboard" class="tab active"></section>
    <section id="log" class="tab"></section>
    <section id="skills" class="tab"></section>
    <section id="analytics" class="tab"></section>
    <section id="health" class="tab"></section>
    <section id="boss" class="tab"></section>
    <section id="challenge" class="tab"></section>
    <section id="backup" class="tab"></section>
  </main>

  <!-- ✅ UI Loader: zeigt Module-Fehler direkt auf dem Screen (ohne Konsole) -->
  <script>
    (function () {
      const info = document.getElementById("playerInfo");
      const show = (msg) => { if (info) info.textContent = msg; };

      show("Lade App…");

      // Cache-bust für iOS/SW (wird nur clientseitig angehängt)
      const v = "v4.0.1";

      import("./js/app.js?v=" + v)
        .then(() => show(""))
        .catch((err) => {
          console.error(err);
          show("JS Fehler: " + (err && err.message ? err.message : String(err)));
          // Optional: Details sichtbar machen
          const pre = document.createElement("pre");
          pre.style.whiteSpace = "pre-wrap";
          pre.style.opacity = "0.85";
          pre.style.fontSize = "12px";
          pre.style.padding = "12px";
          pre.style.borderRadius = "12px";
          pre.style.background = "rgba(255,255,255,0.06)";
          pre.textContent = (err && err.stack) ? err.stack : String(err);
          document.body.insertBefore(pre, document.body.firstChild.nextSibling);
        });

      // Service Worker
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("./sw.js").catch(console.warn);
      }
    })();
  </script>

</body>
</html>
